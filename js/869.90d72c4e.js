"use strict";(self["webpackChunkpanda_nails"]=self["webpackChunkpanda_nails"]||[]).push([[869],{908:function(e,t,s){function a(e){const t=new Date(1e3*e);return t.toLocaleDateString()}function l(e){const t=new Date(1e3*e),s=` ${t.getFullYear()}/${t.getMonth()+1}/${t.getDate()}  ${t.getHours()}:${t.getMinutes()}:${t.getSeconds()}`;return s}function n(e){const t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}s.d(t,{D:function(){return a},lf:function(){return l},$E:function(){return n}})},799:function(e,t,s){s.d(t,{Z:function(){return u}});var a=s(6252);const l={class:"loadingio-spinner-spin-gw0b9unmls"},n=(0,a._)("div",{class:"ldio-jjk31xq51n"},[(0,a._)("div",null,[(0,a._)("div")]),(0,a._)("div",null,[(0,a._)("div")]),(0,a._)("div",null,[(0,a._)("div")]),(0,a._)("div",null,[(0,a._)("div")]),(0,a._)("div",null,[(0,a._)("div")]),(0,a._)("div",null,[(0,a._)("div")]),(0,a._)("div",null,[(0,a._)("div")]),(0,a._)("div",null,[(0,a._)("div")])],-1),i=[n];function o(e,t){return(0,a.wg)(),(0,a.iD)("div",l,i)}var c=s(3744);const r={},d=(0,c.Z)(r,[["render",o]]);var u=d},4439:function(e,t,s){s.d(t,{Z:function(){return x}});var a=s(6252),l=s(3577);const n={class:"list d-flex justify-content-center list-unstyled"},i=(0,a._)("i",{class:"bi bi-card-checklist fs-2"},null,-1),o=(0,a._)("p",{class:"mb-0 mb-lg-3"},"Step 1 .",-1),c=(0,a._)("p",null,"填寫資訊",-1),r=[i,o,c],d=(0,a._)("i",{class:"bi bi-credit-card fs-2"},null,-1),u=(0,a._)("p",{class:"mb-0 mb-lg-3"},"Step 2 .",-1),p=(0,a._)("p",null,"確認付款",-1),m=[d,u,p],f=(0,a._)("i",{class:"bi bi-cart-check fs-2"},null,-1),h=(0,a._)("p",{class:"mb-0 mb-lg-3"},"Step 3 .",-1),g=(0,a._)("p",null,"訂單完成",-1),_=[f,h,g];function b(e,t,s,i,o,c){return(0,a.wg)(),(0,a.iD)("ul",n,[(0,a._)("li",{class:(0,l.C_)(["rounded-circle d-flex flex-column justify-content-center text-nowrap",{active:s.stepStatus.createOrder}])},r,2),(0,a._)("li",{class:(0,l.C_)(["rounded-circle d-flex flex-column justify-content-center text-nowrap",{active:s.stepStatus.payCheck}])},m,2),(0,a._)("li",{class:(0,l.C_)(["rounded-circle d-flex flex-column justify-content-center text-nowrap",{active:s.stepStatus.success}])},_,2)])}var v={props:{stepStatus:{type:Object}}},y=s(3744);const w=(0,y.Z)(v,[["render",b]]);var x=w},2869:function(e,t,s){s.r(t),s.d(t,{default:function(){return ge}});var a=s(6252),l=s(3577),n=s(9963);const i={class:"position-relative"},o=(0,a._)("div",{class:"background-secondary position-absolute h-100 w-100",style:{"z-index":"-1"}},null,-1),c={class:"container pt-5"},r={key:0,class:"row mt-5"},d={class:"col-lg-4"},u={class:"list-unstyled"},p={class:"border-bottom h4 d-flex justify-content-between"},m=(0,a._)("div",null,"訂單明細",-1),f=(0,a._)("i",{class:"far fa-edit"},null,-1),h=(0,a.Uk)(" 修改 "),g=[f,h],_={key:0,style:{"max-height":"500px","overflow-y":"auto"}},b={class:"row g-0"},v={class:"col-4 col-md-3 col-lg-4"},y=["src"],w={class:"col-8 col-md-9 col-lg-8 g-3 d-flex flex-column g-3 justify-content-between"},x={class:"card-body p-1 d-flex flex-column justify-content-between"},k={class:"fs-5 text-start d-flex justify-content-between"},C={class:"text-end"},$={class:"text-start mb-0"},D={class:"text-muted"},S={class:"mb-0 text-end fs-4"},j={key:1},L=(0,a._)("i",{class:"bi bi-info-square fs-1"},null,-1),Z=(0,a._)("p",{class:"fs-7",style:{"letter-spacing":"2px"}},"購物車內沒有商品",-1),V=(0,a.Uk)("挑選商品 "),O={key:0,class:"list-unstyled"},T={class:"input-group mb-3 pt-3 border-top"},U={key:0,type:"text",class:"form-control p-2",placeholder:"已套用優惠券",disabled:""},W=["disabled"],z=(0,a.Uk)(" 套用優惠券 "),X=(0,a._)("div",{class:"loading d-none fade"},null,-1),q=[z,X],E={key:0,class:"border-0 d-flex justify-content-between fs-4"},N=(0,a._)("p",{class:"p-1"},"總計",-1),F={class:"p-1"},M={key:1,class:"border-0 fs-4"},H={class:"fs-5 d-flex justify-content-between"},Y=(0,a._)("p",{class:"p-1"},"總計",-1),I={class:"p-1"},P={class:"d-flex justify-content-between"},B=(0,a._)("p",{class:"p-1"},"折扣後金額：",-1),K={class:"fs-4"},R={class:"col-lg-8 justify-content-center text-start"},A=(0,a._)("div",{class:"text-start h2 border-bottom-0"},"訂購人資訊",-1),G={class:"mb-3"},J=(0,a._)("label",{for:"email",class:"form-label"},[(0,a.Uk)("Email "),(0,a._)("span",{class:"text-danger"},"*")],-1),Q={class:"mb-3"},ee=(0,a._)("label",{for:"name",class:"form-label"},[(0,a.Uk)("收件人姓名 "),(0,a._)("span",{class:"text-danger"},"*")],-1),te={class:"mb-3"},se=(0,a._)("label",{for:"tel",class:"form-label"},[(0,a.Uk)("收件人電話 "),(0,a._)("span",{class:"text-danger"},"*")],-1),ae={class:"mb-3"},le=(0,a._)("label",{for:"message",class:"form-label"},"留言",-1),ne=["disabled"],ie={class:"text-end"},oe=["disabled"];function ce(e,t,s,f,h,z){const X=(0,a.up)("LoadingComponent"),ce=(0,a.up)("VLoading"),re=(0,a.up)("StepStatusComponent"),de=(0,a.up)("RouterLink"),ue=(0,a.up)("VField"),pe=(0,a.up)("ErrorMessage"),me=(0,a.up)("VForm");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(ce,{active:h.isLoading,"z-index":1060},{default:(0,a.w5)((()=>[(0,a.Wm)(X)])),_:1},8,["active"]),(0,a._)("div",i,[o,(0,a._)("div",c,[(0,a.Wm)(re,{"step-status":h.stepStatus},null,8,["step-status"]),h.stepStatus.createOrder?((0,a.wg)(),(0,a.iD)("div",r,[(0,a._)("div",d,[(0,a._)("ul",u,[(0,a._)("li",p,[m,(0,a._)("button",{type:"button",class:"btn border-0",onClick:t[0]||(t[0]=(...e)=>z.openOffcanvas&&z.openOffcanvas(...e))},g)]),h.carts.carts?.length>0?((0,a.wg)(),(0,a.iD)("div",_,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(h.carts.carts,(e=>((0,a.wg)(),(0,a.iD)("li",{class:"card border-0 p-3 background-secondary",key:e.id+"123"},[(0,a._)("div",b,[(0,a._)("div",v,[(0,a._)("img",{src:e.product.imageUrl,class:"img-fluid",style:{"object-fit":"contain"},alt:"cart.product.title"},null,8,y)]),(0,a._)("div",w,[(0,a._)("div",x,[(0,a._)("div",k,[(0,a._)("p",null,(0,l.zw)(e.product.title),1),(0,a._)("small",C,"X"+(0,l.zw)(e.qty),1)]),(0,a._)("p",$,[(0,a._)("small",D,"NT$"+(0,l.zw)(z.toThousandths(e.product.price))+" / "+(0,l.zw)(e.product.unit),1)]),(0,a._)("p",S," NT$"+(0,l.zw)(z.toThousandths(e.qty*e.product.price)),1)])])])])))),128))])):((0,a.wg)(),(0,a.iD)("div",j,[L,Z,(0,a.Wm)(de,{to:"/products",class:"btn btn-primary py-2 px-4"},{default:(0,a.w5)((()=>[V])),_:1})]))]),h.carts.carts?.length>0?((0,a.wg)(),(0,a.iD)("ul",O,[(0,a._)("li",T,[h.isCoupon?((0,a.wg)(),(0,a.iD)("input",U)):(0,a.wy)(((0,a.wg)(),(0,a.iD)("input",{key:1,type:"text",class:"form-control p-2",placeholder:"輸入優惠碼","onUpdate:modelValue":t[1]||(t[1]=e=>h.code=e)},null,512)),[[n.nr,h.code]]),(0,a._)("button",{type:"button",class:"btn btn-primary px-3",disabled:h.isCoupon,onClick:t[2]||(t[2]=e=>z.useCoupon(h.code))},q,8,W)]),h.isCoupon?((0,a.wg)(),(0,a.iD)("li",M,[(0,a._)("small",H,[Y,(0,a._)("del",I,"NT$"+(0,l.zw)(z.toThousandths(h.carts.total)),1)]),(0,a._)("div",P,[B,(0,a._)("span",K,"$ "+(0,l.zw)(z.toThousandths(Math.round(h.carts.final_total)))+" NTD",1)])])):((0,a.wg)(),(0,a.iD)("li",E,[N,(0,a._)("p",F,"NT$"+(0,l.zw)(z.toThousandths(h.carts.final_total)),1)]))])):(0,a.kq)("",!0)]),(0,a._)("div",R,[A,(0,a.Wm)(me,{ref:"form",onSubmit:z.checkOrder},{default:(0,a.w5)((({errors:e})=>[(0,a._)("div",G,[J,(0,a.Wm)(ue,{id:"email",name:"email",type:"email",class:(0,l.C_)(["form-control",{"is-invalid":e["email"]}]),placeholder:"請輸入 Email",rules:"required|email",modelValue:h.form.user.email,"onUpdate:modelValue":t[3]||(t[3]=e=>h.form.user.email=e),disabled:0===h.carts.carts?.length},null,8,["class","modelValue","disabled"]),(0,a.Wm)(pe,{name:"email",class:"invalid-feedback"})]),(0,a._)("div",Q,[ee,(0,a.Wm)(ue,{id:"name",name:"姓名",type:"text",class:(0,l.C_)(["form-control",{"is-invalid":e["姓名"]}]),placeholder:"請輸入姓名",rules:"required",modelValue:h.form.user.name,"onUpdate:modelValue":t[4]||(t[4]=e=>h.form.user.name=e),disabled:0===h.carts.carts?.length},null,8,["class","modelValue","disabled"]),(0,a.Wm)(pe,{name:"姓名",class:"invalid-feedback"})]),(0,a._)("div",te,[se,(0,a.Wm)(ue,{id:"tel",name:"手機",type:"tel",class:(0,l.C_)(["form-control",{"is-invalid":e["手機"]}]),placeholder:"請輸入手機",rules:z.isPhone,modelValue:h.form.user.tel,"onUpdate:modelValue":t[5]||(t[5]=e=>h.form.user.tel=e),disabled:0===h.carts.carts?.length},null,8,["class","rules","modelValue","disabled"]),(0,a.Wm)(pe,{name:"手機",class:"invalid-feedback"})]),(0,a._)("div",ae,[le,(0,a.wy)((0,a._)("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":t[6]||(t[6]=e=>h.form.user.message=e),disabled:0===h.carts.carts?.length},null,8,ne),[[n.nr,h.form.user.message]])]),(0,a._)("div",ie,[(0,a._)("button",{type:"submit",class:"btn btn-primary mb-3",disabled:Object.keys(e).length>0||0===h.carts.carts?.length}," 送出訂單 ",8,oe)])])),_:1},8,["onSubmit"])])])):(0,a.kq)("",!0)])])],64)}var re=s(4902),de=s(799),ue=s(4439),pe=s(908),me={components:{LoadingComponent:de.Z,StepStatusComponent:ue.Z},data(){return{carts:{},isLoadingItem:"",form:{user:{name:"",email:"",tel:"",address:"",message:""}},isLoading:!1,isCoupon:!1,code:"",stepStatus:{createOrder:!0,payCheck:!1,success:!1},order:{}}},watch:{carts(e){e.final_total!==e.total?this.isCoupon=!0:this.isCoupon=!1,0===this.carts.carts?.length&&(re.Z.emit("push-message",{style:"info",title:"購物車無商品",content:"購物車沒東西了～\n頁面即將跳轉回商店"}),setTimeout((()=>{re.Z.emit("emit-close-offcanvas"),this.$router.push("/products")}),1500))}},methods:{DateFn:pe.D,toThousandths:pe.$E,getCarts(){const e="https://vue3-course-api.hexschool.io/v2/api/clothes/cart/";this.isLoading=!0,this.$http.get(e).then((e=>{this.carts=e.data.data,this.isLoading=!1})).catch((e=>{this.isLoading=!1,re.Z.emit("push-message",{style:"danger",title:`${e.response.data.message}`})}))},useCoupon(e){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/v2/api/clothes/coupon",s={code:e};this.$http.post(t,{data:s}).then((t=>{this.isLoading=!1,this.isCoupon=!0,this.code=e,re.Z.emit("push-message",{style:"success",title:`${t.data.message}`}),this.getCarts()})).catch((e=>{this.isLoading=!1,re.Z.emit("push-message",{style:"danger",title:`${e.response.data.message}`})}))},sendOrder(){this.isLoading=!0;const e="https://vue3-course-api.hexschool.io/v2/api/clothes/order";this.form.user.address="台北",console.log(this.form);const t=this.form;this.$http.post(e,{data:t}).then((e=>{this.isLoading=!1,re.Z.emit("push-message",{style:"success",title:`${e.data.message}`}),this.order=e.data,re.Z.emit("get-cart-num"),this.$router.push(`/checkout/${this.order.orderId}`)})).catch((e=>{this.isLoading=!1,re.Z.emit("push-message",{style:"success",title:`${e.response.data.message}`})}))},checkOrder(){this.stepStatus.createOrder=!1,this.stepStatus.payCheck=!0,this.sendOrder()},isPhone(e){const t=/^(09)[0-9]{8}$/;return!!t.test(e)||"請輸入正確的電話號碼: ex:09XXXXXXXX"},openOffcanvas(){re.Z.emit("emit-open-offcanvas")}},mounted(){this.getCarts(),re.Z.on("get-checkout-cart",this.getCarts)}},fe=s(3744);const he=(0,fe.Z)(me,[["render",ce]]);var ge=he}}]);
//# sourceMappingURL=869.90d72c4e.js.map